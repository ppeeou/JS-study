<!DOCTYPE>
<html>

<head>

  <script src="../pubsub.js"></script>

</head>

<body>

  <iframe id="iframe1" src="./iframe1.html" frameborder="0"></iframe>
  <iframe id="iframe2" src="./iframe2.html" frameborder="0"></iframe>

  <button id="publish-thing">Test</button>
  <script>

    window.onload = function () {

      var f1w = document.getElementById('iframe1').contentWindow;
      var f2w = document.getElementById('iframe2').contentWindow;
      var btn = document.getElementById('publish-thing');

      f1w.init(PubSub);
      f2w.init(PubSub);

      PubSub.subscribe('hello-world', function (data) {
        console.log('hello world received at parent - ', data);
      });

      btn.onclick = function () {
        PubSub.publish('hello-world', 'from button in parent document');
      };
    }
  </script>
</body>

</html>